#!/usr/bin/env ruby

root_path = "~/"
plugins = [ "https://github.com/tpope/vim-fugitive",
            "https://github.com/tpope/vim-endwise",
            "https://github.com/tpope/vim-rails",
            "https://github.com/tpope/vim-rake",
            "https://github.com/tomtom/tcomment_vim",
            "https://github.com/tpope/vim-eunuch",
            "https://github.com/nathanaelkane/vim-indent-guides",
            "https://github.com/kana/vim-smartinput",
            "https://github.com/mileszs/ack.vim",
            "https://github.com/kien/ctrlp.vim/",
            "https://github.com/tpope/vim-surround",
            "https://github.com/tpope/vim-unimpaired",
            "https://github.com/tpope/vim-markdown",
            "https://github.com/vim-ruby/vim-ruby",
            "https://github.com/pangloss/vim-javascript",
            "https://github.com/tpope/vim-haml",
            "https://github.com/cakebaker/scss-syntax.vim",
            "https://github.com/kchmck/vim-coffee-script",
            "https://github.com/walm/jshint.vim",
            "https://github.com/bbommarito/vim-slim",
            "https://github.com/benmills/vimux",
            "https://github.com/Lokaltog/vim-powerline",
            "https://github.com/altercation/vim-colors-solarized" ]

def install_plugins(root_path, plugins)
  Dir.chdir(File.expand_path("#{root_path}.vim/bundle/"))
  plugins.each do |repo|
    print "\n"
    system "git clone #{repo}"
  end
end

def install_plugin_customizations
  # js syntax file
  system "cp ~/Dropbox/Code/General/dotfiles/custom/syntax/javascript.vim ~/.vim/bundle/vim-javascript/syntax/javascript.vim"
  # powerline theme
  system "cp ~/Dropbox/Code/General/dotfiles/custom/themes/powerline/josh.vim ~/.vim/bundle/vim-powerline/autoload/Powerline/Colorschemes/josh.vim"
end

def do_install(root_path, plugins)
  Dir.chdir(File.expand_path(root_path))

  puts "\n\ncreating directory structure\n\n"
  system "mkdir -p #{root_path}.vim/{_backup,_temp,_cache,autoload,bundle}"

  puts "\n\ninstalling pathogen\n\n"
  system "curl https://raw.github.com/tpope/vim-pathogen/HEAD/autoload/pathogen.vim > #{root_path}.vim/autoload/pathogen.vim"

  puts "\n\ninstalling plugins\n\n"
  install_plugins(root_path, plugins)

  puts "\n\ninstalling your plugin customizations\n\n"
  install_plugin_customizations
end

do_install(root_path, plugins) unless Dir.exists?(File.expand_path("#{root_path}.vim"))
